<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>CSE Department â€“ Admin Panel</title>
    <link rel="icon" href="image.png" />

    <!-- Theme bootstrap (same style as achievements.html) -->
    <script>
        (function () {
            try {
                const saved = localStorage.getItem('theme');
                const prefersDark = window.matchMedia &&
                    window.matchMedia('(prefers-color-scheme: dark)').matches;

                const theme = saved || (prefersDark ? 'dark' : 'light');
                document.documentElement.setAttribute('data-theme', theme);
            } catch (e) {
                document.documentElement.setAttribute('data-theme', 'light');
            }
        })();
    </script>

    <link rel="stylesheet" href="styles.css" />

    <!-- CryptoJS for SHA-256 hashing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js"></script>

    <style>
        /* Loader (same style as achievements page) */
        .loader {
            position: fixed;
            top: 50%;
            left: 50%;
            width: 55px;
            height: 55px;
            margin-top: -27.5px;
            margin-left: -27.5px;
            border: 5px solid #ddd;
            border-top-color: #7D2AE8;
            border-radius: 50%;
            animation: spin 0.9s linear infinite;
            z-index: 5000;
            display: none;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* Container similar spacing to achievements */
        .admin-container {
            max-width: 1200px;
            margin: 120px auto 40px;
            padding: 0 20px 40px;
        }

        @media (max-width: 600px) {
            .admin-container {
                margin-top: 100px;
            }
        }

        /* Center login card */
        .login-wrapper {
            display: flex;
            justify-content: center;
            align-items: flex-start;
        }

        .login-card {
            background: var(--card-bg);
            border-radius: 18px;
            padding: 26px 28px 24px;
            box-shadow: 0 20px 45px rgba(15, 23, 42, 0.35);
            border: 1px solid rgba(148, 163, 184, 0.35);
            max-width: 380px;
            width: 100%;
            text-align: center;
        }

        .login-card h2 {
            margin: 0 0 14px;
            font-size: 22px;
            color: #ffffff;
        }

        .login-field {
            text-align: left;
            margin-bottom: 16px;
        }

        .login-field label {
            display: block;
            font-size: 13px;
            margin-bottom: 6px;
        }

        .login-field input {
            width: 100%;
            padding: 10px 12px;
            border-radius: 10px;
            border: 1px solid #bfbfbf;
            font-size: 14px;
            outline: none;
            background: #ffffff;
            color: #000000;
        }

        .login-field input:focus {
            border-color: #7D2AE8;
            box-shadow: 0 0 0 3px rgba(125, 42, 232, 0.22);
        }

        .btn-primary {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            padding: 10px 20px;
            border-radius: 999px;
            background: #7D2AE8;
            color: #ffffff;
            border: none;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            width: 100%;
            box-shadow: 0 10px 24px rgba(125, 42, 232, 0.40);
            transition: transform 0.15s ease, box-shadow 0.2s ease, background 0.2s ease;
        }

        .btn-primary:hover {
            background: #6922dd;
            transform: translateY(-1px);
            box-shadow: 0 16px 32px rgba(125, 42, 232, 0.65);
        }

        .login-error {
            margin-top: 10px;
            font-size: 13px;
            color: #f97373;
            min-height: 18px;
        }

        /* Admin cards (forms) */
        .admin-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 28px;
        }

        .admin-card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 18px;
            border: 1px solid rgba(148, 163, 184, 0.45);
            box-shadow: 0 10px 30px rgba(15, 23, 42, 0.30);
        }

        .admin-card h3 {
            margin: 0 0 6px;
            font-size: 18px;
            color: #ffffff;
        }

        .admin-card p {
            margin: 0 0 10px;
            font-size: 14px;
            color: var(--muted);
        }

        .admin-card .btn-row {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 10px;
        }

        .btn-outline {
            padding: 8px 14px;
            border-radius: 999px;
            border: 1px solid #7D2AE8;
            background: transparent;
            color: #7D2AE8;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
        }

        .btn-outline:hover {
            background: rgba(125, 42, 232, 0.1);
        }

        .form-frame {
            display: none;
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid rgba(148, 163, 184, 0.6);
        }

        .form-frame iframe {
            width: 100%;
            height: 430px;
            border: 0;
            background: #ffffff;
        }

        .admin-note {
            margin-top: 22px;
            font-size: 13px;
            color: var(--muted);
        }
    </style>
</head>

<body>

    <!-- NAVBAR (same as achievements but only Home) -->
    <nav class="nav">
        <div class="nav-inner">
            <a href="index.html" class="brand">
                <img src="image.png" alt="CSE logo">
                <div>
                    <h1>CSE Department</h1>
                    <div class="brand-sub">SRM Valliammai Engineering College</div>
                </div>
            </a>

            <div class="menu">
                <a href="index.html" id="homeLink">Home</a>
            </div>

            <button class="hamb" id="hamb" aria-label="Toggle navigation" aria-expanded="false">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>

        <div class="mobile-menu" id="mobileMenu">
            <a href="index.html" id="homeLinkMobile">Home</a>
        </div>
    </nav>

    <!-- MAIN CONTENT -->
    <main class="admin-container">

        <!-- LOGIN -->
        <div id="loginSection" class="login-wrapper">
            <div class="login-card">
                <h2>Admin Login</h2>
                <div class="login-field">
                    <label for="adminPass">Password</label>
                    <input type="password" id="adminPass" autocomplete="off" />
                </div>
                <button class="btn-primary" id="loginBtn">Login</button>
                <div class="login-error" id="loginError"></div>
            </div>
        </div>

        <!-- ADMIN PANEL (hidden until login) -->
        <section id="adminPanel" style="display:none;">
            <div class="admin-header">
                <h2>Admin Content Update Panel</h2>
                <p class="muted">Submit updates. They will reflect directly on the main CSE website.</p>
            </div>

            <div class="admin-grid">

                <!-- Placement -->
                <div class="admin-card">
                    <h3>Placement Update Form</h3>
                    <p>Submit student placement details. Please ensure information is correct.</p>
                    <button class="btn-primary open-form" data-url="placement">Open Form</button>
                </div>

                <!-- Achievements -->
                <div class="admin-card">
                    <h3>Achievements & Events Form</h3>
                    <p>Submit achievements & major events conducted by CSE Department.</p>
                    <button class="btn-primary open-form" data-url="achievements">Open Form</button>
                </div>

                <!-- Coderizz -->
                <div class="admin-card">
                    <h3>Coderizz Events Form</h3>
                    <p>Submit Coderizz club updates and contributions.</p>
                    <button class="btn-primary open-form" data-url="coderizz">Open Form</button>
                </div>

            </div>

            <p class="admin-note">
                âš  Refreshing this page will log you out of admin mode. Please avoid refreshing.
            </p>
        </section>

    </main>

    <!-- FLOATING CONTROLS (same as achievements) -->
    <div class="floating-controls">
        <button id="themeToggle" class="fab" aria-label="Toggle Theme">ðŸŒ™</button>
        <button id="backToTop" class="fab" aria-label="Back To Top">â†‘</button>
    </div>

    <!-- Loader -->
    <div id="loader" class="loader"></div>

    <script>
        /************ CONFIG â€“ YOU WILL REPLACE THESE ************/

        // 1) SHA-256 hash of your real password
        const PASSWORD_HASH = "cb5876123a5ec69555dd5efe00d9ec8904745848d21eb835457d2121be5a73e7";

        // 2) Base64-encoded Google Form URLs
        const B64_PLACEMENT = "aHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vZm9ybXMvZC9lLzFGQUlwUUxTY19XRktuV0NzX1ZzY09rRDN1TXZTY2RSQWthTlZ5bDFGZ0R3dW10RHM3a0V3Ry1BL3ZpZXdmb3Jt";
        const B64_ACHIEVEMENTS = "aHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vZm9ybXMvZC9lLzFGQUlwUUxTZW1NcTBPWnE2dWlSTF9Leng0Q2Zxa2tvQjYtODdkdEJsQ1ZydGdpYVltY0tDejdnL3ZpZXdmb3Jt";
        const B64_CODERIZZ = "aHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vZm9ybXMvZC9lLzFGQUlwUUxTZEVzWVFSdFMxMndNdUtuckltdWpOeVJzbzVKZ3B2Z0hHMVNwQlVmaVdLM3hpS1VBL3ZpZXdmb3Jt";

        /***************** BASIC UI HELPERS *****************/
        const loader = document.getElementById("loader");
        const loginSection = document.getElementById("loginSection");
        const adminPanel = document.getElementById("adminPanel");
        const loginError = document.getElementById("loginError");
        const passInput = document.getElementById("adminPass");
        const loginBtn = document.getElementById("loginBtn");

        let isLoggedIn = false;

        function showLoader() { loader.style.display = "block"; }
        function hideLoader() { loader.style.display = "none"; }

        /***************** NAV + THEME *****************/
        const hamb = document.getElementById('hamb');
        const mobileMenu = document.getElementById('mobileMenu');

        hamb.addEventListener('click', () => {
            const isOpen = mobileMenu.classList.toggle('open');
            hamb.classList.toggle('open', isOpen);
            hamb.setAttribute('aria-expanded', isOpen ? 'true' : 'false');
        });

        mobileMenu.querySelectorAll("a").forEach(link => {
            link.addEventListener("click", () => {
                mobileMenu.classList.remove("open");
                hamb.classList.remove("open");
                hamb.setAttribute("aria-expanded", "false");
            });
        });

        const themeToggle = document.getElementById("themeToggle");
        const root = document.documentElement;

        function updateThemeIcon() {
            const theme = root.getAttribute("data-theme") || "light";
            themeToggle.textContent = theme === "dark" ? "â˜€ï¸" : "ðŸŒ™";
        }
        themeToggle.addEventListener("click", () => {
            const current = root.getAttribute("data-theme") || "light";
            const next = current === "light" ? "dark" : "light";
            root.setAttribute("data-theme", next);
            try { localStorage.setItem("theme", next); } catch { }
            updateThemeIcon();
        });
        updateThemeIcon();

        const backToTop = document.getElementById("backToTop");
        window.addEventListener("scroll", () =>
            backToTop.classList.toggle("visible", window.scrollY > 300)
        );
        backToTop.addEventListener("click", () =>
            window.scrollTo({ top: 0, behavior: "smooth" })
        );

        // Home navigation â†’ clear session
        if (document.getElementById("homeLink")) {
            document.getElementById("homeLink").addEventListener("click", () => {
                sessionStorage.removeItem("adminLoggedIn");
            });
        }

        /***************** SECURITY: Block dev tools attempts *****************/
        document.addEventListener("contextmenu", e => e.preventDefault());
        document.addEventListener("keydown", e => {
            if (
                e.key === "F12" ||
                (e.ctrlKey && e.shiftKey && ["I", "J", "C"].includes(e.key)) ||
                (e.ctrlKey && e.key === "U")
            ) {
                e.preventDefault();
            }
        });

        /***************** PASSWORD CHECK (SHA-256) *****************/
        function getSha256Hex(text) {
            return CryptoJS.SHA256(text).toString();
        }

        async function handleLogin() {
            loginError.textContent = "";
            const pwd = passInput.value.trim();
            if (!pwd) {
                loginError.textContent = "Please enter the password.";
                return;
            }

            showLoader();
            const enteredHash = getSha256Hex(pwd);

            if (enteredHash === PASSWORD_HASH) {
                isLoggedIn = true;
                sessionStorage.setItem("adminLoggedIn", "1");
                loginSection.style.display = "none";
                adminPanel.style.display = "block";
            } else {
                loginError.textContent = "Incorrect password.";
            }
            hideLoader();
        }

        loginBtn.addEventListener("click", handleLogin);
        passInput.addEventListener("keydown", e => {
            if (e.key === "Enter") handleLogin();
        });

        /***************** OPEN LINKS ONLY AFTER LOGIN *****************/
        function decodeUrl(b64) { return atob(b64); }

        document.querySelectorAll(".open-form").forEach(btn => {
            btn.addEventListener("click", () => {
                if (!isLoggedIn) return alert("Please login first!");

                const type = btn.dataset.url;
                let url = "";

                if (type === "placement") url = decodeUrl(B64_PLACEMENT);
                if (type === "achievements") url = decodeUrl(B64_ACHIEVEMENTS);
                if (type === "coderizz") url = decodeUrl(B64_CODERIZZ);

                if (url) window.open(url, "_blank");
            });
        });

        /***************** ON REFRESH: LOGOUT FORCEFULLY *****************/
        window.addEventListener("beforeunload", (e) => {
            if (!isLoggedIn) return;
            e.preventDefault();
            e.returnValue = "";
        });

        window.addEventListener("load", () => {
            const wasLoggedIn = sessionStorage.getItem("adminLoggedIn") === "1";
            if (wasLoggedIn) {
                sessionStorage.removeItem("adminLoggedIn");
                loginError.textContent = "Session expired due to refresh. Enter password again.";
            }
            hideLoader();
        });
    </script>


</body>

</html>
